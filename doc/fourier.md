
# Calculating a function via Fourier series and plotting the results in Matlab
_This document was automatically generated from file_ **`fourier.cpp`** (mƒÅtricks-v2.13-r48).

## Fourier Series for the Claussen Functions
As our example, we'll use the [Claussen functions](http://mathworld.wolfram.com/ClausenFunction.html). The Claussen function of order _n_ has Fourier series: 
![Claussen Functions](ClaussenDefinition.PNG)
### Claussen function of order _n=1_


Set up the output format so that we can copy and paste into Matlab
```C++
using namespace display;
FormatDataVector::string_opening = "[ ...\n    ";
FormatDataVector::string_delimeter = ", ";
FormatDataVector::max_elements_per_line = 5;
FormatDataVector::string_endofline = " ...\n    ";
FormatDataVector::string_closing = " ...\n]";
setFormatString<double>("% 10.6e");
FormatData<double>::tens = false;
```

Define the coefficient vectors: 

```C++
const size_type N = 20;
Vector<double> An = 1./range<double>(0,N-1);
An[0] = 0.;
Vector<double> Bn = Vector<double>(N,0.);
```

Define the coordinate vector `t` as 51 points over the interval [-2pi,+2pi]: 

```C++
const double pi = 3.14159265358979323846;
Vector<double> t = linspace<double>(-2*pi,2*pi,51);
```

Calculate the Fourier series and store the results in vector `Cl1`: 

```C++
const double T = 2*pi;
const double omega = 1;
Vector<double> Cl1 = ifourier(An,Bn, t, An.size(), omega );
```

The results `t` and `Cl1` are:

```Matlab
t = [ ...
    -6.283185e+00, -6.031858e+00, -5.780530e+00, -5.529203e+00, -5.277876e+00,  ...
    -5.026548e+00, -4.775221e+00, -4.523893e+00, -4.272566e+00, -4.021239e+00,  ...
    -3.769911e+00, -3.518584e+00, -3.267256e+00, -3.015929e+00, -2.764602e+00,  ...
    -2.513274e+00, -2.261947e+00, -2.010619e+00, -1.759292e+00, -1.507964e+00,  ...
    -1.256637e+00, -1.005310e+00, -7.539822e-01, -5.026548e-01, -2.513274e-01,  ...
     8.881784e-16,  2.513274e-01,  5.026548e-01,  7.539822e-01,  1.005310e+00,  ...
     1.256637e+00,  1.507964e+00,  1.759292e+00,  2.010619e+00,  2.261947e+00,  ...
     2.513274e+00,  2.764602e+00,  3.015929e+00,  3.267256e+00,  3.518584e+00,  ...
     3.769911e+00,  4.021239e+00,  4.272566e+00,  4.523893e+00,  4.775221e+00,  ...
     5.026548e+00,  5.277876e+00,  5.529203e+00,  5.780530e+00,  6.031858e+00,  ...
     6.283185e+00 ...
]; 
Cl1 = [ ...
     3.547740e+00,  1.188378e+00,  6.702121e-01,  3.668447e-01,  7.165111e-02,  ...
    -1.885479e-01, -3.475374e-01, -4.235060e-01, -4.936908e-01, -5.899252e-01,  ...
    -6.686552e-01, -6.877307e-01, -6.713629e-01, -6.713629e-01, -6.877307e-01,  ...
    -6.686552e-01, -5.899252e-01, -4.936908e-01, -4.235060e-01, -3.475374e-01,  ...
    -1.885479e-01,  7.165111e-02,  3.668447e-01,  6.702121e-01,  1.188378e+00,  ...
     3.547740e+00,  1.188378e+00,  6.702121e-01,  3.668447e-01,  7.165111e-02,  ...
    -1.885479e-01, -3.475374e-01, -4.235060e-01, -4.936908e-01, -5.899252e-01,  ...
    -6.686552e-01, -6.877307e-01, -6.713629e-01, -6.713629e-01, -6.877307e-01,  ...
    -6.686552e-01, -5.899252e-01, -4.936908e-01, -4.235060e-01, -3.475374e-01,  ...
    -1.885479e-01,  7.165111e-02,  3.668447e-01,  6.702121e-01,  1.188378e+00,  ...
     3.547740e+00 ...
]; 
```
Cut and paste the above data for r and y into Matlab as well as the following commands

```Matlab
```
This yields the following plot comparing the Taylor series [red dots] to the exact function [solid blue].
![Taylor Series for Jo(r)](BesselTaylorSeries.png)
### Claussen function of order _n=2_


Set up the output format so that we can copy and paste into Matlab
```C++
using namespace display;
FormatDataVector::string_opening = "[ ...\n    ";
FormatDataVector::string_delimeter = ", ";
FormatDataVector::max_elements_per_line = 5;
FormatDataVector::string_endofline = " ...\n    ";
FormatDataVector::string_closing = " ...\n]";
setFormatString<double>("% 10.6e");
FormatData<double>::tens = false;
```

Define the coefficient vectors: 

```C++
const size_type N = 20;
Vector<double> An = Vector<double>(N,0.);
Vector<double> Bn = 1./sqr(range<double>(0,N-1));
Bn[0] = 0.;
```

Define the coordinate vector `t` as 51 points over the interval [0,+2pi]: 

```C++
const double pi = 3.14159265358979323846;
Vector<double> t = linspace<double>(0,2*pi,51);
```

Calculate the Fourier series and store the results in vector `Cl1`: 

```C++
const double T = 2*pi;
const double omega = 1;
Vector<double> Cl2 = ifourier(An,Bn, t, An.size(), omega );
```

The results `t` and `Cl2` are:

```Matlab
t = [ ...
     0.000000e+00,  1.256637e-01,  2.513274e-01,  3.769911e-01,  5.026548e-01,  ...
     6.283185e-01,  7.539822e-01,  8.796459e-01,  1.005310e+00,  1.130973e+00,  ...
     1.256637e+00,  1.382301e+00,  1.507964e+00,  1.633628e+00,  1.759292e+00,  ...
     1.884956e+00,  2.010619e+00,  2.136283e+00,  2.261947e+00,  2.387610e+00,  ...
     2.513274e+00,  2.638938e+00,  2.764602e+00,  2.890265e+00,  3.015929e+00,  ...
     3.141593e+00,  3.267256e+00,  3.392920e+00,  3.518584e+00,  3.644247e+00,  ...
     3.769911e+00,  3.895575e+00,  4.021239e+00,  4.146902e+00,  4.272566e+00,  ...
     4.398230e+00,  4.523893e+00,  4.649557e+00,  4.775221e+00,  4.900885e+00,  ...
     5.026548e+00,  5.152212e+00,  5.277876e+00,  5.403539e+00,  5.529203e+00,  ...
     5.654867e+00,  5.780530e+00,  5.906194e+00,  6.031858e+00,  6.157522e+00,  ...
     6.283185e+00 ...
]; 
Cl2 = [ ...
     0.000000e+00,  3.915666e-01,  6.000432e-01,  7.410133e-01,  8.551813e-01,  ...
     9.200436e-01,  9.743620e-01,  1.002639e+00,  1.012039e+00,  1.014431e+00,  ...
     9.956523e-01,  9.722114e-01,  9.376397e-01,  8.915632e-01,  8.439166e-01,  ...
     7.839127e-01,  7.214527e-01,  6.544238e-01,  5.793518e-01,  5.056759e-01,  ...
     4.246733e-01,  3.425731e-01,  2.602467e-01,  1.722467e-01,  8.785563e-02,  ...
    -2.153608e-16, -8.785563e-02, -1.722467e-01, -2.602467e-01, -3.425731e-01,  ...
    -4.246733e-01, -5.056759e-01, -5.793518e-01, -6.544238e-01, -7.214527e-01,  ...
    -7.839127e-01, -8.439166e-01, -8.915632e-01, -9.376397e-01, -9.722114e-01,  ...
    -9.956523e-01, -1.014431e+00, -1.012039e+00, -1.002639e+00, -9.743620e-01,  ...
    -9.200436e-01, -8.551813e-01, -7.410133e-01, -6.000432e-01, -3.915666e-01,  ...
    -9.123002e-16 ...
]; 
```
Cut and paste the above data for r and y into Matlab as well as the following commands

```Matlab
```
This yields the following plot comparing the Taylor series [red dots] to the exact function [solid blue].
![Taylor Series for Jo(r)](BesselTaylorSeries.png)

[Table of Contents](README.md)
